<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bandejita de Lata | Cocina de Autor</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

    <style>
        :root {
            /* PALETA DE COLORES */
            --blue: #135c96;       
            --green: #96b754;      
            --soft-green: #d2dc84; 
            --bg: #f9f9f9;         
            --white: #ffffff;      
            --text-grey: #444444;
            --shadow: 0 10px 30px -10px rgba(19, 92, 150, 0.15); 
        }

        body { 
            margin: 0; 
            font-family: 'Montserrat', sans-serif; 
            background-color: var(--bg); 
            color: var(--text-grey); 
            padding-bottom: 120px; 
            -webkit-font-smoothing: antialiased;
        }
        
        h1, h2, h3 { font-family: 'Playfair Display', serif; color: var(--blue); font-weight: 700; margin-top: 0; }
        p { font-weight: 400; line-height: 1.6; margin-bottom: 10px; }

        /* HEADER */
        header {
            height: 35vh;
            min-height: 250px;
            /*  TU URL RAW DE GITHUB AQU  */
            background-image: url('https://raw.githubusercontent.com/GalderEG/web-bandejita/main/bandejita%20de%20lata-6.jpg'); 
            background-size: cover; 
            background-position: center; 
            position: relative;
        }

        /* LOGO */
        .header-logo-container {
            position: absolute; bottom: -50px; left: 50%; transform: translateX(-50%); z-index: 60;
            background: var(--white); padding: 5px; border-radius: 50%;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .header-logo {
            width: 100px; height: 100px; object-fit: contain; border-radius: 50%;
            display: block; background-color: #fff;
        }
        
        /* NAVEGACIN */
        .nav-tabs {
            display: flex; background: var(--white); box-shadow: 0 2px 10px rgba(0,0,0,0.03);
            position: sticky; top: 0; z-index: 50; padding-top: 55px; 
        }
        .tab-btn {
            flex: 1; padding: 15px; border: none; background: none;
            font-family: 'Montserrat', sans-serif; font-weight: 600; text-transform: uppercase;
            font-size: 0.75rem; color: #999; cursor: pointer; transition: 0.3s;
            border-bottom: 3px solid transparent; letter-spacing: 1px;
        }
        .tab-btn.active { color: var(--blue); border-bottom: 3px solid var(--green); }

        .container { max-width: 700px; margin: 0 auto; padding: 30px 20px 10px 20px; }
        
        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeUp 0.6s ease-out; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* TARJETAS INFO */
        .info-card {
            background: var(--white); border-radius: 12px; padding: 25px; margin-bottom: 25px;
            box-shadow: var(--shadow); border-top: 4px solid var(--green);
        }
        .news-item { 
            border-left: 3px solid var(--green); background: #f4f8f0; padding: 15px; margin-bottom: 15px; border-radius: 0 8px 8px 0;
        }
        .hours-item { 
            display: flex; justify-content: space-between; border-bottom: 1px dashed #ddd; padding: 12px 0; 
        }

        /* --- NUEVO: CARRUSEL DE TESTIMONIOS --- */
        .reviews-wrapper {
            margin-bottom: 25px;
        }
        .reviews-scroll {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 15px; /* Espacio para scrollbar si aparece */
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch; /* Suavidad en iOS/Android */
        }
        /* Ocultar scrollbar pero mantener funcionalidad */
        .reviews-scroll::-webkit-scrollbar { display: none; }
        .reviews-scroll { -ms-overflow-style: none; scrollbar-width: none; }

        .review-card {
            min-width: 260px; /* Ancho fijo para que se vean uniformes */
            max-width: 260px;
            background: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            scroll-snap-align: center; /* Se centra al soltar */
            border-top: 1px solid #eee;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .review-header {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;
        }
        .review-author {
            font-family: 'Playfair Display', serif; font-weight: 700; color: var(--blue); font-size: 1rem;
        }
        .review-stars {
            color: var(--green); font-size: 0.9rem; letter-spacing: 1px;
        }
        .review-text {
            font-size: 0.85rem; color: #555; font-style: italic; line-height: 1.5;
        }
        
        /* MEN */
        .category-title {
            color: var(--blue); border-bottom: 1px solid #ddd; padding-bottom: 10px;
            margin: 40px 0 20px 0; text-transform: uppercase; letter-spacing: 2px; font-size: 1.2rem; text-align: center;
        }
        .card {
            background: var(--white); border-radius: 12px; padding: 20px; margin-bottom: 18px;
            box-shadow: var(--shadow); display: flex; justify-content: space-between; align-items: center;
            transition: all 0.3s ease; border: 1px solid transparent;
        }
        .card.destacado {
            border: 1px solid var(--green); background: linear-gradient(to right, #ffffff, #fcfdf6); position: relative; 
        }
        .badge-rec {
            position: absolute; top: -10px; right: 15px;
            background: var(--green); color: var(--white); font-size: 0.65rem; font-weight: 600; padding: 4px 10px;
            border-radius: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); text-transform: uppercase; letter-spacing: 0.5px;
        }
        .dish-name { font-size: 1.1rem; font-weight: 700; color: var(--blue); margin: 0 0 5px 0; font-family: 'Playfair Display', serif; }
        .dish-desc { font-size: 0.85rem; color: #666; line-height: 1.5; padding-right: 10px;}
        .price-tag { text-align: right; min-width: 70px; }
        .usd { color: var(--blue); font-weight: 700; font-size: 1.2rem; }

        /* FOOTER */
        .zone-contact {
            text-align: center; padding: 50px 20px; background: var(--white); border-top: 1px solid #e0e0e0; margin-top: 50px;
        }
        .zone-title {
            font-family: 'Playfair Display', serif; font-size: 1.5rem; color: var(--blue); margin-bottom: 5px;
        }
        .zone-handle { font-size: 1rem; color: #888; margin-bottom: 30px; display: block; }
        .contact-grid { display: flex; justify-content: center; gap: 25px; flex-wrap: wrap; }
        .icon-btn {
            width: 55px; height: 55px; border-radius: 50%; background: var(--white); border: 2px solid var(--blue);
            color: var(--blue); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; 
            text-decoration: none; transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .icon-btn:hover { 
            background: var(--green); color: var(--white); border-color: var(--green); transform: translateY(-5px); 
        }

        /* FAB WHATSAPP */
        .fab {
            position: fixed; bottom: 25px; right: 20px; background-color: var(--green); color: white;
            padding: 14px 28px; border-radius: 50px; font-family: 'Montserrat', sans-serif; font-weight: 600; 
            font-size: 0.95rem; text-decoration: none; box-shadow: 0 4px 20px rgba(150, 183, 84, 0.4);
            display: flex; align-items: center; gap: 10px; z-index: 100; transition: transform 0.2s; letter-spacing: 0.5px;
            animation: pulse-green 2s infinite;
        }
        .fab:hover { transform: scale(1.05); animation: none; }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(150, 183, 84, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(150, 183, 84, 0); }
            100% { box-shadow: 0 0 0 0 rgba(150, 183, 84, 0); }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-logo-container">
            <img src="https://via.placeholder.com/150/FFFFFF/000000?text=LOGO" alt="Logo Bandejita" class="header-logo" id="logo-img">
        </div>
    </header>

    <nav class="nav-tabs">
        <button class="tab-btn active" onclick="switchTab('inicio')">Principal</button>
        <button class="tab-btn" onclick="switchTab('menu')">Nuestro Men煤</button>
    </nav>

    <div class="container">
        <div id="inicio" class="view-section active">
            <div style="text-align: center; margin-bottom: 40px; margin-top: 10px;">
                <h1 style="font-size: 2.5rem; margin-bottom: 10px;">Bandejita de Lata</h1>
                <p style="font-size: 1rem; color: var(--blue); letter-spacing: 1px;">COCINA DE AUTOR</p>
                <div style="width: 50px; height: 2px; background: var(--green); margin: 20px auto;"></div>
            </div>

            <div class="info-card" id="news-box" style="display:none; border-top-color: var(--blue);">
                <h3 style="font-size:1.1rem;"><i class="fa-solid fa-bullhorn" style="color:var(--green); margin-right:8px;"></i> Novedades</h3>
                <div id="news-content"></div>
            </div>

            <div class="info-card">
                <h3 style="font-size:1.1rem;"><i class="fa-solid fa-utensils" style="margin-right:8px;"></i> Nuestra Cocina</h3>
                <p style="font-size:0.9rem; color:#666;">Nacimos para ofrecerte una experiencia gastron贸mica honesta. Cada plato es preparado al momento con ingredientes frescos y recetas propias que reconfortan el alma.</p>
            </div>

            <div id="reviews-box" class="reviews-wrapper" style="display:none;">
                <h3 style="font-size:1.1rem; margin-bottom:15px; margin-left:5px;"><i class="fa-solid fa-star" style="color:var(--green); margin-right:8px;"></i> Clientes Felices</h3>
                <div id="reviews-container" class="reviews-scroll">
                    </div>
            </div>

            <div class="info-card">
                <h3 style="font-size:1.1rem;"><i class="fa-regular fa-clock" style="margin-right:8px;"></i> Horarios</h3>
                <div id="hours-content"><p style="text-align:center; color:#999;">Cargando horarios...</p></div>
            </div>
        </div>

        <div id="menu" class="view-section">
            <div id="menu-content">
                <div style="text-align:center; padding:80px 20px;">
                    <i class="fa-solid fa-circle-notch fa-spin" style="font-size:2rem; color:var(--soft-green); margin-bottom: 20px;"></i>
                    <p style="color:#999;">Preparando los fogones...</p>
                </div>
            </div>
        </div>
    </div>

    <div class="zone-contact">
        <div class="zone-title">S铆guenos</div>
        <span class="zone-handle">@angelchaconcocinero</span>
        <div class="contact-grid">
            <a href="https://instagram.com/angelchaconcocinero" target="_blank" class="icon-btn" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
            <a href="https://tiktok.com/@angelchaconcocinero" target="_blank" class="icon-btn" aria-label="TikTok"><i class="fa-brands fa-tiktok"></i></a>
            <a href="https://facebook.com/angelchaconcocinero" target="_blank" class="icon-btn" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
            <a href="https://maps.app.goo.gl/TU_ENLACE_DE_MAPS" target="_blank" class="icon-btn" aria-label="Ubicaci贸n"><i class="fa-solid fa-location-dot"></i></a>
        </div>
        <p style="font-size: 0.75rem; color: #ccc; margin-top: 30px;">San Crist贸bal, Venezuela</p>
    </div>

    <a href="#" id="whatsapp-btn" class="fab">
        <i class="fa-brands fa-whatsapp" style="font-size:1.3rem;"></i> <span>Realizar Pedido</span>
    </a>

    <script>
        const TELEFONO = "584120767007"; 
        const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSfR6ILf3cDq51hVw-GBANJ1wpfH5NrKgBgPvaYMAUeSiWLpWUCsCPJIkA5m-Ok1E7NpPtJtLzfAURH/pub?gid=0&single=true&output=csv"; 

        function switchTab(tabName) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            const btnIndex = tabName === 'inicio' ? 0 : 1;
            document.querySelectorAll('.tab-btn')[btnIndex].classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        const params = new URLSearchParams(window.location.search);
        let origen = params.get('origen') || 'web';
        document.getElementById('whatsapp-btn').href = `https://wa.me/${TELEFONO}?text=${encodeURIComponent("Hola ngel, vengo de " + origen + " y quisiera hacer un pedido.")}`;

        function parseCSV(text) {
            let filas = []; let filaActual = []; let celda = ""; let enComillas = false;
            for (let i = 0; i < text.length; i++) {
                let char = text[i]; let nextChar = text[i+1];
                if (char === '"') { 
                    if (enComillas && nextChar === '"') { celda += '"'; i++; } else { enComillas = !enComillas; } 
                } else if (char === ',' && !enComillas) { filaActual.push(celda); celda = ""; } 
                else if (char === '\n' && !enComillas) { filaActual.push(celda); filas.push(filaActual); filaActual = []; celda = ""; } 
                else if (char !== '\r') { celda += char; }
            }
            if (celda || filaActual.length > 0) { filaActual.push(celda); filas.push(filaActual); }
            return filas;
        }

        async function cargarTodo() {
            try {
                const response = await fetch(SHEET_CSV_URL);
                const data = await response.text();
                const filas = parseCSV(data);
                
                const menuContainer = document.getElementById('menu-content');
                const newsContainer = document.getElementById('news-content');
                const hoursContainer = document.getElementById('hours-content');
                const reviewsContainer = document.getElementById('reviews-container');
                const reviewsBox = document.getElementById('reviews-box');
                
                menuContainer.innerHTML = ''; newsContainer.innerHTML = ''; hoursContainer.innerHTML = ''; reviewsContainer.innerHTML = '';

                const menuPorCategoria = {}; const ordenCategorias = []; 
                let hayNoticias = false; let hayReviews = false;

                filas.forEach((fila, index) => {
                    if (index === 0) return;
                    
                    const nombre = fila[0] ? fila[0].trim() : '';
                    const desc = fila[1] ? fila[1].trim() : '';
                    const precio = fila[2] ? fila[2].replace('$', '').trim() : '';
                    const categoria = fila[3] ? fila[3].trim() : 'Otros';
                    const disponible = fila[4] ? fila[4].toLowerCase().trim() : '';
                    const destacado = fila[5] ? fila[5].toLowerCase().trim() : '';

                    if (nombre && disponible === 'si') {
                        // NOTICIAS
                        if (categoria.toLowerCase() === 'noticias') {
                            hayNoticias = true;
                            newsContainer.innerHTML += `<div class="news-item"><h4 style="margin:0 0 5px 0; color:var(--blue);">${nombre}</h4><p style="margin:0; font-size:0.9rem;">${desc}</p></div>`;
                            return;
                        }
                        // HORARIOS
                        if (categoria.toLowerCase() === 'horarios') {
                            hoursContainer.innerHTML += `<div class="hours-item"><span style="font-weight:600; color:var(--blue);">${nombre}</span><span style="font-size:0.9rem;">${desc}</span></div>`;
                            return;
                        }
                        // TESTIMONIOS (NUEVO)
                        if (categoria.toLowerCase() === 'testimonios') {
                            hayReviews = true;
                            reviewsContainer.innerHTML += `
                                <div class="review-card">
                                    <div class="review-header">
                                        <div class="review-author">${nombre}</div>
                                        <div class="review-stars">${precio}</div> </div>
                                    <p class="review-text">"${desc}"</p>
                                </div>`;
                            return;
                        }

                        // MEN NORMAL
                        if (!menuPorCategoria[categoria]) { menuPorCategoria[categoria] = []; ordenCategorias.push(categoria); }
                        menuPorCategoria[categoria].push({ nombre, desc, precio, destacado: destacado === 'si' });
                    }
                });

                if(hayNoticias) document.getElementById('news-box').style.display = 'block';
                if(hayReviews) reviewsBox.style.display = 'block'; // Mostrar secci贸n si hay rese帽as
                if(hoursContainer.innerHTML === '') hoursContainer.innerHTML = '<p>Consultar WhatsApp</p>';

                if (ordenCategorias.length === 0) {
                     menuContainer.innerHTML = '<div style="text-align:center; padding:40px;"><p>No hay platos disponibles en este momento.</p></div>';
                } else {
                    ordenCategorias.forEach(cat => {
                        const platos = menuPorCategoria[cat];
                        platos.sort((a, b) => {
                            if (a.destacado && !b.destacado) return -1;
                            if (!a.destacado && b.destacado) return 1;
                            return a.nombre.localeCompare(b.nombre);
                        });
                        menuContainer.innerHTML += `<h2 class="category-title">${cat}</h2>`;
                        platos.forEach((plato, i) => {
                            const delay = Math.min(i * 0.05, 0.5);
                            menuContainer.innerHTML += `
                                <div class="card ${plato.destacado ? 'destacado' : ''}" style="animation: fadeUp 0.5s ease-out forwards; animation-delay: ${delay}s; opacity:0;">
                                    ${plato.destacado ? '<div class="badge-rec"><i class="fa-solid fa-star"></i> Recomendado</div>' : ''}
                                    <div class="info">
                                        <div class="dish-name">${plato.nombre}</div>
                                        <p class="dish-desc">${plato.desc}</p>
                                    </div>
                                    <div class="price-tag"><span class="usd">$${plato.precio}</span></div>
                                </div>`;
                        });
                    });
                }
            } catch (error) { 
                console.error(error); 
                document.getElementById('menu-content').innerHTML = '<p style="text-align:center;">Error cargando el men煤.</p>';
            }
        }
        cargarTodo();
    </script>
</body>
</html>
